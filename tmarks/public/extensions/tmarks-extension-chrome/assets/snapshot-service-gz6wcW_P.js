const s={inlineCSS:!0,inlineImages:!0,inlineFonts:!1,removeScripts:!0,removeHiddenElements:!1,maxImageSize:5242880,timeout:3e4};async function i(r,e={}){const o={...s,...e};try{console.log("[SnapshotService] Starting capture with SingleFile...");const t=await chrome.tabs.sendMessage(r,{type:"CAPTURE_PAGE",options:o});if(t.success){const n=(t.size/1024).toFixed(1);return console.log(`[SnapshotService] Capture successful: ${n}KB`),t.html}else throw new Error(t.error||"Capture failed")}catch(t){return console.error("[SnapshotService] SingleFile capture failed:",t),console.log("[SnapshotService] Falling back to simple capture"),c(r)}}async function c(r){try{const e=await chrome.scripting.executeScript({target:{tabId:r},func:()=>document.documentElement.outerHTML});if(e&&e[0]&&e[0].result)return console.log("[SnapshotService] Simple capture successful"),e[0].result;throw new Error("Failed to capture page content")}catch(e){throw console.error("[SnapshotService] Simple capture failed:",e),e}}export{i as capturePageSnapshot};
