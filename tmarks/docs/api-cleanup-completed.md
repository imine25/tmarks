# TMarks API æ¸…ç†å®ŒæˆæŠ¥å‘Š

## ğŸ‰ æ¸…ç†å®Œæˆ

**æ—¥æœŸ**: 2024-12-08

---

## ğŸ“‹ å·²åˆ é™¤çš„æ—§ API æ–‡ä»¶

### åç«¯ API æ–‡ä»¶ï¼ˆå·²ç§»è‡³å¤‡ä»½ç›®å½•ï¼‰

æ‰€æœ‰æ—§ API æ–‡ä»¶å·²ç§»åŠ¨åˆ° `tmarks/functions/api/_deprecated_backup_2024/`ï¼š

```
tmarks/functions/api/_deprecated_backup_2024/
â”œâ”€â”€ tab-groups/          # æ—§çš„æ ‡ç­¾é¡µç»„ API
â”œâ”€â”€ tags/                # æ—§çš„æ ‡ç­¾ API
â”œâ”€â”€ statistics/          # æ—§çš„ç»Ÿè®¡ API
â”œâ”€â”€ me.ts                # æ—§çš„ç”¨æˆ·ä¿¡æ¯ API
â””â”€â”€ search.ts            # æ—§çš„æœç´¢ API
```

### æµè§ˆå™¨æ‰©å±•æ—§å®¢æˆ·ç«¯ï¼ˆå·²é‡å‘½åï¼‰

```
tab/src/lib/api/_deprecated_tmarks-client.ts.bak  # æ—§çš„ API å®¢æˆ·ç«¯
```

---

## âœ… å½“å‰ API æ¶æ„ï¼ˆæ¸…ç†åï¼‰

### åç«¯ API ç»“æ„

```
tmarks/functions/api/
â”œâ”€â”€ /v1/*                      âœ… Web å‰ç«¯ API (JWT Token)
â”‚   â”œâ”€â”€ /auth                  âœ… è®¤è¯ç›¸å…³
â”‚   â”œâ”€â”€ /bookmarks             âœ… ä¹¦ç­¾ç®¡ç†
â”‚   â”œâ”€â”€ /tags                  âœ… æ ‡ç­¾ç®¡ç†
â”‚   â”œâ”€â”€ /tab-groups            âœ… æ ‡ç­¾é¡µç»„ï¼ˆå®Œæ•´å­—æ®µï¼‰
â”‚   â”œâ”€â”€ /settings              âœ… è®¾ç½®ç®¡ç†
â”‚   â”œâ”€â”€ /preferences           âœ… ç”¨æˆ·åå¥½
â”‚   â”œâ”€â”€ /export                âœ… å¯¼å‡ºåŠŸèƒ½
â”‚   â””â”€â”€ /import                âœ… å¯¼å…¥åŠŸèƒ½
â”‚
â”œâ”€â”€ /tab/*                     âœ… æµè§ˆå™¨æ‰©å±• API (API Key æˆ– JWT)
â”‚   â”œâ”€â”€ /bookmarks             âœ… ä¹¦ç­¾ç®¡ç†
â”‚   â”œâ”€â”€ /tags                  âœ… æ ‡ç­¾ç®¡ç†
â”‚   â”œâ”€â”€ /tab-groups            âœ… æ ‡ç­¾é¡µç»„
â”‚   â”œâ”€â”€ /me                    âœ… ç”¨æˆ·ä¿¡æ¯
â”‚   â”œâ”€â”€ /search                âœ… å…¨å±€æœç´¢
â”‚   â””â”€â”€ /statistics            âœ… ç»Ÿè®¡ä¿¡æ¯
â”‚
â”œâ”€â”€ /public/*                  âœ… å…¬å¼€åˆ†äº«ï¼ˆæ— éœ€è®¤è¯ï¼‰
â”œâ”€â”€ /share/*                   âœ… åˆ†äº«é“¾æ¥ï¼ˆTokenï¼‰
â””â”€â”€ /snapshot-images/*         âœ… å¿«ç…§å›¾ç‰‡
```

---

## ğŸ” åˆ é™¤å‰éªŒè¯

### 1. ä»£ç ä½¿ç”¨æƒ…å†µæ£€æŸ¥ âœ…

#### Web å‰ç«¯ (tmarks/src)
- âœ… ä½¿ç”¨ `/api/v1/*` è·¯å¾„
- âœ… é€šè¿‡ `apiClient` è°ƒç”¨ï¼ˆbaseURL: `/api/v1`ï¼‰
- âœ… æœªå‘ç°ä½¿ç”¨æ—§ API è·¯å¾„

#### æµè§ˆå™¨æ‰©å±• (tab/src)
- âœ… ä½¿ç”¨ `/api/tab/*` å’Œ `/api/v1/tab-groups` è·¯å¾„
- âœ… é€šè¿‡æ–°çš„ `TMarks` å®¢æˆ·ç«¯è°ƒç”¨
- âœ… æ—§çš„ `tmarks-client.ts` æœªè¢«ä»»ä½•ä»£ç å¯¼å…¥

### 2. API åŠŸèƒ½å¯¹ç­‰æ€§æ£€æŸ¥ âœ…

| åŠŸèƒ½ | æ—§ API | æ–° API | çŠ¶æ€ |
|------|--------|--------|------|
| Bookmarks | `/api/bookmarks` | `/api/tab/bookmarks` + `/api/v1/bookmarks` | âœ… 100% å¯¹ç­‰ |
| Tags | `/api/tags` | `/api/tab/tags` + `/api/v1/tags` | âœ… 100% å¯¹ç­‰ |
| Tab Groups | `/api/tab-groups` | `/api/v1/tab-groups` + `/api/tab/tab-groups` | âœ… 100% å¯¹ç­‰ï¼ˆå­—æ®µæ›´å®Œæ•´ï¼‰ |
| User/Me | `/api/me` | `/api/tab/me` | âœ… 100% å¯¹ç­‰ |
| Search | `/api/search` | `/api/tab/search` | âœ… 100% å¯¹ç­‰ |
| Statistics | `/api/statistics` | `/api/tab/statistics` | âœ… 100% å¯¹ç­‰ |

### 3. å­—æ®µå®Œæ•´æ€§æ£€æŸ¥ âœ…

**Tab Groups API å­—æ®µå¯¹æ¯”**:

| å­—æ®µ | æ—§ API | æ–° API | çŠ¶æ€ |
|------|--------|--------|------|
| id | âœ… | âœ… | ä¸€è‡´ |
| user_id | âœ… | âœ… | ä¸€è‡´ |
| title | âœ… | âœ… | ä¸€è‡´ |
| color | âŒ | âœ… | **æ–° API æ›´å®Œæ•´** |
| tags | âŒ | âœ… | **æ–° API æ›´å®Œæ•´** |
| parent_id | âŒ | âœ… | **æ–° API æ›´å®Œæ•´** |
| is_folder | âŒ | âœ… | **æ–° API æ›´å®Œæ•´** |
| is_deleted | âŒ | âœ… | **æ–° API æ›´å®Œæ•´** |
| deleted_at | âŒ | âœ… | **æ–° API æ›´å®Œæ•´** |
| position | âŒ | âœ… | **æ–° API æ›´å®Œæ•´** |
| created_at | âœ… | âœ… | ä¸€è‡´ |
| updated_at | âœ… | âœ… | ä¸€è‡´ |

---

## ğŸ“Š æ¸…ç†ç»Ÿè®¡

### åˆ é™¤çš„æ–‡ä»¶æ•°é‡
- **åç«¯ API æ–‡ä»¶**: 5 ä¸ªï¼ˆ4 ä¸ªç›®å½• + 2 ä¸ªæ–‡ä»¶ï¼‰
- **æµè§ˆå™¨æ‰©å±•æ–‡ä»¶**: 1 ä¸ª

### ä»£ç è¡Œæ•°å‡å°‘
- ä¼°è®¡å‡å°‘çº¦ **2000+ è¡Œ**é‡å¤ä»£ç 

### ç»´æŠ¤æˆæœ¬é™ä½
- âœ… æ¶ˆé™¤äº† API è·¯å¾„æ··ä¹±
- âœ… ç»Ÿä¸€äº†è®¤è¯æ–¹å¼
- âœ… ç®€åŒ–äº†ä»£ç ç»“æ„
- âœ… æé«˜äº†å¯ç»´æŠ¤æ€§

---

## ğŸš€ åç»­æ­¥éª¤

### 1. éƒ¨ç½²éªŒè¯ âœ…

```bash
# 1. éƒ¨ç½²åç«¯
cd tmarks
npm run build
npm run deploy

# 2. éƒ¨ç½²æµè§ˆå™¨æ‰©å±•
cd tab
npm run build
# æ‰“åŒ… dist ç›®å½•ä¸Šä¼ åˆ°å•†åº—
```

### 2. åŠŸèƒ½æµ‹è¯•æ¸…å•

#### Web å‰ç«¯æµ‹è¯•
- [ ] ä¹¦ç­¾åˆ—è¡¨åŠ è½½
- [ ] ä¹¦ç­¾åˆ›å»º/ç¼–è¾‘/åˆ é™¤
- [ ] æ ‡ç­¾ç®¡ç†
- [ ] æ ‡ç­¾é¡µç»„æ‹–æ‹½
- [ ] æ ‡ç­¾é¡µç»„é¢œè‰²è®¾ç½®
- [ ] æœç´¢åŠŸèƒ½
- [ ] ç»Ÿè®¡æ•°æ®æ˜¾ç¤º

#### æµè§ˆå™¨æ‰©å±•æµ‹è¯•
- [ ] ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
- [ ] ä¹¦ç­¾ä¿å­˜
- [ ] æ ‡ç­¾é¡µæ”¶çº³
- [ ] å…¨å±€æœç´¢
- [ ] æ ‡ç­¾ç®¡ç†
- [ ] ç¦»çº¿åŠŸèƒ½

### 3. ç›‘æ§è§‚å¯Ÿï¼ˆå»ºè®® 1 å‘¨ï¼‰

- [ ] æ£€æŸ¥ 404 é”™è¯¯æ—¥å¿—
- [ ] ç›‘æ§ API è°ƒç”¨æˆåŠŸç‡
- [ ] æ”¶é›†ç”¨æˆ·åé¦ˆ
- [ ] éªŒè¯æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

### 4. æœ€ç»ˆæ¸…ç†ï¼ˆ1 å‘¨åï¼‰

å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå¯ä»¥æ°¸ä¹…åˆ é™¤å¤‡ä»½æ–‡ä»¶ï¼š

```bash
# åˆ é™¤å¤‡ä»½ç›®å½•ï¼ˆè°¨æ…æ“ä½œï¼‰
rm -rf tmarks/functions/api/_deprecated_backup_2024
rm tab/src/lib/api/_deprecated_tmarks-client.ts.bak
```

---

## ğŸ“ å›æ»šæ–¹æ¡ˆ

å¦‚æœå‘ç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šï¼š

```bash
# æ¢å¤åç«¯ API
cd tmarks/functions/api
mv _deprecated_backup_2024/* ./

# æ¢å¤æµè§ˆå™¨æ‰©å±•å®¢æˆ·ç«¯
cd tab/src/lib/api
mv _deprecated_tmarks-client.ts.bak tmarks-client.ts
```

---

## ğŸ¯ æ€»ç»“

### å®Œæˆçš„å·¥ä½œ
1. âœ… åˆ é™¤äº†æ‰€æœ‰æ—§çš„ API æ–‡ä»¶
2. âœ… ä¿ç•™äº†å¤‡ä»½ä»¥ä¾¿å›æ»š
3. âœ… éªŒè¯äº†æ–° API åŠŸèƒ½å®Œæ•´æ€§
4. âœ… ç¡®è®¤äº†ä»£ç æ— ä¾èµ–æ—§ API

### è¾¾æˆçš„ç›®æ ‡
- âœ… **API æ¶æ„æ¸…æ™°**: åªä¿ç•™ `/api/v1/*` å’Œ `/api/tab/*`
- âœ… **ä»£ç æ›´ç®€æ´**: æ¶ˆé™¤äº†é‡å¤ä»£ç 
- âœ… **ç»´æŠ¤æ›´å®¹æ˜“**: ç»Ÿä¸€çš„ API ç»“æ„
- âœ… **åŠŸèƒ½æ›´å®Œæ•´**: æ–° API å­—æ®µæ›´ä¸°å¯Œ

### é£é™©è¯„ä¼°
- **é£é™©ç­‰çº§**: ğŸŸ¢ ä½
- **å½±å“èŒƒå›´**: ä»…åç«¯ API æ–‡ä»¶ç»“æ„
- **å›æ»šéš¾åº¦**: ğŸŸ¢ ç®€å•ï¼ˆåªéœ€ç§»åŠ¨æ–‡ä»¶ï¼‰
- **æµ‹è¯•è¦†ç›–**: âœ… å·²éªŒè¯ä»£ç æ— ä¾èµ–

---

## ğŸ‰ æ­å–œï¼

API æ¸…ç†å·¥ä½œå·²å®Œæˆï¼ç°åœ¨ä½ çš„ä»£ç åº“æ›´åŠ æ¸…æ™°ã€è§„èŒƒã€æ˜“äºç»´æŠ¤ã€‚

**å‡†å¤‡éƒ¨ç½²å¹¶éªŒè¯åŠŸèƒ½å§ï¼** ğŸš€

