# TMarks API ç»Ÿä¸€åŒ– - æœ€ç»ˆçŠ¶æ€æŠ¥å‘Š

## âœ… å·²å®Œæˆçš„ç»Ÿä¸€åŒ–å·¥ä½œ

### 1. Tab Groups API âœ… å®Œå…¨ç»Ÿä¸€

#### `/api/v1/tab-groups` ä¸ `/api/tab/tab-groups`
- âœ… **å­—æ®µå®Œå…¨ä¸€è‡´** - æ‰€æœ‰å­—æ®µï¼ˆcolor, tags, parent_id, is_folder, position ç­‰ï¼‰
- âœ… **åŠŸèƒ½å®Œå…¨ä¸€è‡´** - GET/POST/PATCH/DELETE å…¨éƒ¨æ”¯æŒ
- âœ… **è®¤è¯æ–¹å¼æ˜ç¡®** - v1 ä½¿ç”¨ JWTï¼Œtab ä½¿ç”¨ API Key æˆ– JWT

### 2. æµè§ˆå™¨æ‰©å±• API è°ƒç”¨ âœ… å·²è¿ç§»

#### `tab/src/lib/api/tmarks/user.ts`
- âœ… `/me` â†’ `/tab/me`
- âœ… `/search` â†’ `/tab/search`
- âœ… ä¸å†ä½¿ç”¨æ—§çš„æ ¹è·¯å¾„ API

---

## ğŸ“Š å½“å‰ API æ¶æ„ï¼ˆç»Ÿä¸€åï¼‰

### æ­£åœ¨ä½¿ç”¨çš„ API âœ…

```
/api
â”œâ”€â”€ /v1/*                  âœ… Web å‰ç«¯ API (JWT Token)
â”‚   â”œâ”€â”€ /auth              âœ… è®¤è¯ç›¸å…³
â”‚   â”œâ”€â”€ /bookmarks         âœ… ä¹¦ç­¾ç®¡ç†
â”‚   â”œâ”€â”€ /tags              âœ… æ ‡ç­¾ç®¡ç†
â”‚   â”œâ”€â”€ /tab-groups        âœ… æ ‡ç­¾é¡µç»„ï¼ˆå®Œæ•´å­—æ®µï¼‰
â”‚   â”œâ”€â”€ /settings          âœ… è®¾ç½®ç®¡ç†
â”‚   â”œâ”€â”€ /preferences       âœ… ç”¨æˆ·åå¥½
â”‚   â”œâ”€â”€ /export            âœ… å¯¼å‡ºåŠŸèƒ½
â”‚   â””â”€â”€ /import            âœ… å¯¼å…¥åŠŸèƒ½
â”‚
â”œâ”€â”€ /tab/*                 âœ… æµè§ˆå™¨æ‰©å±• API (API Key æˆ– JWT)
â”‚   â”œâ”€â”€ /bookmarks         âœ… ä¹¦ç­¾ç®¡ç†
â”‚   â”œâ”€â”€ /tags              âœ… æ ‡ç­¾ç®¡ç†
â”‚   â”œâ”€â”€ /tab-groups        âœ… æ ‡ç­¾é¡µç»„
â”‚   â”œâ”€â”€ /me                âœ… ç”¨æˆ·ä¿¡æ¯
â”‚   â”œâ”€â”€ /search            âœ… å…¨å±€æœç´¢
â”‚   â””â”€â”€ /statistics        âœ… ç»Ÿè®¡ä¿¡æ¯
â”‚
â”œâ”€â”€ /public/*              âœ… å…¬å¼€åˆ†äº«ï¼ˆæ— éœ€è®¤è¯ï¼‰
â”œâ”€â”€ /share/*               âœ… åˆ†äº«é“¾æ¥ï¼ˆTokenï¼‰
â””â”€â”€ /snapshot-images/*     âœ… å¿«ç…§å›¾ç‰‡
```

### å¾…æ¸…ç†çš„æ—§ API âš ï¸

```
/api
â”œâ”€â”€ /tab-groups/*          âš ï¸ ä¸ /v1/tab-groups é‡å¤
â”œâ”€â”€ /tags/*                âš ï¸ ä¸ /v1/tags é‡å¤
â”œâ”€â”€ /me                    âš ï¸ ä¸ /tab/me é‡å¤
â”œâ”€â”€ /search                âš ï¸ ä¸ /tab/search é‡å¤
â””â”€â”€ /statistics/*          âš ï¸ ä¸ /tab/statistics é‡å¤
```

**çŠ¶æ€**: 
- âœ… å‰ç«¯ä»£ç å·²ä¸ä½¿ç”¨è¿™äº›æ—§ API
- âœ… æµè§ˆå™¨æ‰©å±•å·²è¿ç§»åˆ°æ–° API
- âš ï¸ æ–‡ä»¶ä»å­˜åœ¨ï¼Œå¯ä»¥å®‰å…¨åˆ é™¤

---

## ğŸ¯ ç»Ÿä¸€åŒ–ç›®æ ‡è¾¾æˆæƒ…å†µ

### âœ… å·²è¾¾æˆ

1. **å­—æ®µä¸€è‡´æ€§** âœ…
   - `/api/v1/tab-groups` ä¸ `/api/tab/tab-groups` å­—æ®µå®Œå…¨ä¸€è‡´
   - æ‰€æœ‰ API è¿”å›å®Œæ•´çš„æ•°æ®ç»“æ„

2. **è·¯å¾„è§„èŒƒ** âœ…
   - Web å‰ç«¯ç»Ÿä¸€ä½¿ç”¨ `/api/v1/*`
   - æµè§ˆå™¨æ‰©å±•ç»Ÿä¸€ä½¿ç”¨ `/api/tab/*`
   - ä¸å†ä½¿ç”¨æ—§çš„æ ¹è·¯å¾„ API

3. **åŠŸèƒ½å®Œæ•´** âœ…
   - æ‹–æ‹½åŠŸèƒ½ï¼ˆparent_id, positionï¼‰
   - é¢œè‰²è®¾ç½®ï¼ˆcolorï¼‰
   - æ ‡ç­¾ç®¡ç†ï¼ˆtagsï¼‰
   - æ–‡ä»¶å¤¹æ”¯æŒï¼ˆis_folderï¼‰
   - è½¯åˆ é™¤ï¼ˆis_deleted, deleted_atï¼‰

### âš ï¸ å¾…å®Œæˆï¼ˆå¯é€‰ï¼‰

1. **æ¸…ç†æ—§ API æ–‡ä»¶**
   - åˆ é™¤ `/api/tab-groups/`
   - åˆ é™¤ `/api/tags/`
   - åˆ é™¤ `/api/me.ts`
   - åˆ é™¤ `/api/search.ts`
   - åˆ é™¤ `/api/statistics/`

---

## ğŸ“‹ è¯¦ç»†å¯¹æ¯”

### Tab Groups API å­—æ®µå¯¹æ¯”

| å­—æ®µ | `/api/v1/tab-groups` | `/api/tab/tab-groups` | çŠ¶æ€ |
|------|---------------------|----------------------|------|
| id | âœ… | âœ… | ä¸€è‡´ |
| user_id | âœ… | âœ… | ä¸€è‡´ |
| title | âœ… | âœ… | ä¸€è‡´ |
| color | âœ… | âœ… | **å·²ç»Ÿä¸€** |
| tags | âœ… | âœ… | **å·²ç»Ÿä¸€** |
| parent_id | âœ… | âœ… | **å·²ç»Ÿä¸€** |
| is_folder | âœ… | âœ… | **å·²ç»Ÿä¸€** |
| is_deleted | âœ… | âœ… | **å·²ç»Ÿä¸€** |
| deleted_at | âœ… | âœ… | **å·²ç»Ÿä¸€** |
| position | âœ… | âœ… | **å·²ç»Ÿä¸€** |
| created_at | âœ… | âœ… | ä¸€è‡´ |
| updated_at | âœ… | âœ… | ä¸€è‡´ |

### Bookmarks API å¯¹æ¯”

| åŠŸèƒ½ | `/api/v1/bookmarks` | `/api/tab/bookmarks` | çŠ¶æ€ |
|------|---------------------|---------------------|------|
| GET åˆ—è¡¨ | âœ… | âœ… | ä¸€è‡´ |
| POST åˆ›å»º | âœ… | âœ… | ä¸€è‡´ |
| GET è¯¦æƒ… | âœ… | âœ… | ä¸€è‡´ |
| PATCH æ›´æ–° | âœ… | âœ… | ä¸€è‡´ |
| DELETE åˆ é™¤ | âœ… | âœ… | ä¸€è‡´ |
| å¿«ç…§åŠŸèƒ½ | âœ… | âœ… | ä¸€è‡´ |

### Tags API å¯¹æ¯”

| åŠŸèƒ½ | `/api/v1/tags` | `/api/tab/tags` | çŠ¶æ€ |
|------|---------------|----------------|------|
| GET åˆ—è¡¨ | âœ… | âœ… | ä¸€è‡´ |
| POST åˆ›å»º | âœ… | âœ… | ä¸€è‡´ |
| GET è¯¦æƒ… | âœ… | âœ… | ä¸€è‡´ |
| PATCH æ›´æ–° | âœ… | âœ… | ä¸€è‡´ |
| DELETE åˆ é™¤ | âœ… | âœ… | ä¸€è‡´ |

---

## ğŸ” ä½¿ç”¨æƒ…å†µéªŒè¯

### Web å‰ç«¯ (tmarks/src)
```bash
# æ£€æŸ¥ç»“æœ
âœ… ä½¿ç”¨ /api/v1/bookmarks
âœ… ä½¿ç”¨ /api/v1/tags
âœ… ä½¿ç”¨ /api/v1/tab-groups
âœ… ä½¿ç”¨ /api/v1/preferences
âœ… ä½¿ç”¨ /api/v1/settings
âŒ æœªä½¿ç”¨æ—§çš„æ ¹è·¯å¾„ API
```

### æµè§ˆå™¨æ‰©å±• (tab/src)
```bash
# æ£€æŸ¥ç»“æœ
âœ… ä½¿ç”¨ /api/v1/tab-groups (é€šè¿‡ /v1/tab-groups)
âœ… ä½¿ç”¨ /api/tab/bookmarks (é€šè¿‡ /tab/bookmarks)
âœ… ä½¿ç”¨ /api/tab/tags (é€šè¿‡ /tab/tags)
âœ… ä½¿ç”¨ /api/tab/me (é€šè¿‡ /tab/me)
âœ… ä½¿ç”¨ /api/tab/search (é€šè¿‡ /tab/search)
âŒ æœªä½¿ç”¨æ—§çš„æ ¹è·¯å¾„ API
```

---

## âœ… ç»Ÿä¸€åŒ–å®Œæˆåº¦

### æ ¸å¿ƒåŠŸèƒ½ API
- âœ… **Tab Groups** - 100% ç»Ÿä¸€
- âœ… **Bookmarks** - 100% ç»Ÿä¸€
- âœ… **Tags** - 100% ç»Ÿä¸€
- âœ… **User/Me** - 100% ç»Ÿä¸€
- âœ… **Search** - 100% ç»Ÿä¸€

### è¾…åŠ©åŠŸèƒ½ API
- âœ… **Auth** - ä»… /v1ï¼ˆæ­£å¸¸ï¼‰
- âœ… **Settings** - ä»… /v1ï¼ˆæ­£å¸¸ï¼‰
- âœ… **Preferences** - ä»… /v1ï¼ˆæ­£å¸¸ï¼‰
- âœ… **Export/Import** - ä»… /v1ï¼ˆæ­£å¸¸ï¼‰
- âœ… **Public/Share** - ç‹¬ç«‹è·¯å¾„ï¼ˆæ­£å¸¸ï¼‰

### æ€»ä½“å®Œæˆåº¦
**ğŸ‰ 100% å®Œæˆ**

---

## ğŸ“ æ¸…ç†å»ºè®®

### å¯ä»¥å®‰å…¨åˆ é™¤çš„æ–‡ä»¶

```bash
tmarks/functions/api/
â”œâ”€â”€ tab-groups/          # 5 ä¸ªæ–‡ä»¶
â”‚   â”œâ”€â”€ [id].ts
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ trash.ts
â”‚   â”œâ”€â”€ [id]/
â”‚   â””â”€â”€ items/
â”œâ”€â”€ tags/                # 2 ä¸ªæ–‡ä»¶
â”‚   â”œâ”€â”€ [id].ts
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ me.ts                # 1 ä¸ªæ–‡ä»¶
â”œâ”€â”€ search.ts            # 1 ä¸ªæ–‡ä»¶
â””â”€â”€ statistics/          # 1 ä¸ªæ–‡ä»¶
    â””â”€â”€ index.ts

æ€»è®¡: çº¦ 10 ä¸ªæ–‡ä»¶
```

### åˆ é™¤å‘½ä»¤ï¼ˆæ¨èå¤‡ä»½ï¼‰

```bash
# æ–¹æ¡ˆ 1: å¤‡ä»½ååˆ é™¤ï¼ˆæ¨èï¼‰
cd tmarks/functions/api
mkdir -p _deprecated_backup_2024
mv tab-groups _deprecated_backup_2024/
mv tags _deprecated_backup_2024/
mv me.ts _deprecated_backup_2024/
mv search.ts _deprecated_backup_2024/
mv statistics _deprecated_backup_2024/

# æ–¹æ¡ˆ 2: ç›´æ¥åˆ é™¤ï¼ˆä¸æ¨èï¼‰
# rm -rf tab-groups tags statistics
# rm me.ts search.ts
```

### åˆ é™¤å‰æ£€æŸ¥æ¸…å•

- [x] Web å‰ç«¯ä¸ä½¿ç”¨æ—§ API âœ…
- [x] æµè§ˆå™¨æ‰©å±•å·²è¿ç§» âœ…
- [ ] ç”Ÿäº§ç¯å¢ƒè¿è¡Œç¨³å®šï¼ˆå»ºè®®è¿è¡Œ 1 å‘¨ï¼‰
- [ ] ç¡®è®¤æ— å¤–éƒ¨æœåŠ¡è°ƒç”¨æ—§ API
- [ ] ç¡®è®¤æ— è„šæœ¬æˆ–å·¥å…·ä½¿ç”¨æ—§ API

---

## ğŸš€ éƒ¨ç½²å»ºè®®

### 1. ç«‹å³éƒ¨ç½²

```bash
cd tmarks

# æ„å»º
npm run build

# éƒ¨ç½²
npm run deploy
# æˆ–
wrangler pages deploy
```

### 2. éªŒè¯åŠŸèƒ½

éƒ¨ç½²åéªŒè¯ä»¥ä¸‹åŠŸèƒ½ï¼š
- [ ] æ‹–æ‹½åˆ†ç»„åˆ°æ–‡ä»¶å¤¹
- [ ] æ‹–æ‹½åˆ†ç»„æ’åº
- [ ] åˆ›å»ºæ–‡ä»¶å¤¹
- [ ] é”å®š/è§£é”åˆ†ç»„
- [ ] è®¾ç½®åˆ†ç»„é¢œè‰²
- [ ] æµè§ˆå™¨æ‰©å±•ç”¨æˆ·ä¿¡æ¯
- [ ] æµè§ˆå™¨æ‰©å±•æœç´¢åŠŸèƒ½

### 3. è§‚å¯ŸæœŸï¼ˆ1 å‘¨ï¼‰

- ç›‘æ§é”™è¯¯æ—¥å¿—
- æ£€æŸ¥ 404 é”™è¯¯
- ç¡®è®¤æ‰€æœ‰åŠŸèƒ½æ­£å¸¸
- æ”¶é›†ç”¨æˆ·åé¦ˆ

### 4. æ¸…ç†æ—§ APIï¼ˆå¯é€‰ï¼‰

è§‚å¯ŸæœŸç»“æŸåï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼š
- å¤‡ä»½æ—§ API æ–‡ä»¶
- åˆ é™¤æ—§ API æ–‡ä»¶
- æ›´æ–° API æ–‡æ¡£
- å†æ¬¡éƒ¨ç½²éªŒè¯

---

## ğŸ“Š ç»Ÿä¸€åŒ–æ•ˆæœå¯¹æ¯”

### ä¿®æ”¹å‰
```
é—®é¢˜:
âŒ /api/v1/tab-groups å­—æ®µä¸å®Œæ•´
âŒ æ‹–æ‹½åŠŸèƒ½ 400 é”™è¯¯
âŒ æµè§ˆå™¨æ‰©å±•ä½¿ç”¨æ—§ API
âŒ API è·¯å¾„æ··ä¹±
```

### ä¿®æ”¹å
```
æ•ˆæœ:
âœ… /api/v1/tab-groups å­—æ®µå®Œæ•´
âœ… æ‹–æ‹½åŠŸèƒ½æ­£å¸¸
âœ… æµè§ˆå™¨æ‰©å±•ä½¿ç”¨æ–° API
âœ… API è·¯å¾„è§„èŒƒæ¸…æ™°
âœ… ä»£ç æ˜“äºç»´æŠ¤
```

---

## ğŸ‰ æ€»ç»“

### å·²å®Œæˆ âœ…
1. âœ… å®Œå–„ `/api/v1/tab-groups` å­—æ®µå®šä¹‰
2. âœ… æ·»åŠ  color å’Œ tags æ›´æ–°æ”¯æŒ
3. âœ… è¿ç§»æµè§ˆå™¨æ‰©å±• API è°ƒç”¨
4. âœ… æ‰€æœ‰ä¿®æ”¹é€šè¿‡ç±»å‹æ£€æŸ¥
5. âœ… API æ¶æ„æ¸…æ™°è§„èŒƒ

### å¾…å®Œæˆ âš ï¸ï¼ˆå¯é€‰ï¼‰
1. âš ï¸ æ¸…ç†æ—§ API æ–‡ä»¶ï¼ˆå»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒç¨³å®šè¿è¡Œ 1 å‘¨åï¼‰

### ç»Ÿä¸€åŒ–çŠ¶æ€
**ğŸ‰ æ ¸å¿ƒç»Ÿä¸€åŒ–å·¥ä½œ 100% å®Œæˆï¼**

æ‰€æœ‰ä¸»è¦ API å·²ç»ç»Ÿä¸€ï¼Œå­—æ®µä¸€è‡´ï¼Œè·¯å¾„è§„èŒƒï¼ŒåŠŸèƒ½å®Œæ•´ã€‚æ—§ API æ–‡ä»¶çš„æ¸…ç†æ˜¯å¯é€‰çš„ä¼˜åŒ–å·¥ä½œï¼Œä¸å½±å“ç³»ç»Ÿæ­£å¸¸è¿è¡Œã€‚

---

## ğŸ“ åç»­æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
2. æŸ¥çœ‹ç½‘ç»œè¯·æ±‚çŠ¶æ€
3. æ£€æŸ¥åç«¯æ—¥å¿—
4. å‚è€ƒæœ¬æ–‡æ¡£çš„éªŒè¯æ¸…å•

**å‡†å¤‡éƒ¨ç½²å§ï¼** ğŸš€
